# Phase 4 Advanced Security Configuration Template
# Add these variables to your .env file for Phase 4 security features

# ===========================================
# ENCRYPTION CONFIGURATION
# ===========================================

# Master encryption key for AES-256 field-level encryption
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY="your-32-byte-base64-encoded-encryption-key-here"

# Salt for key derivation (PBKDF2)
# Generate with: openssl rand -base64 16
ENCRYPTION_SALT="your-16-byte-base64-encoded-salt-here"

# Key rotation interval (in days)
ENCRYPTION_KEY_ROTATION_DAYS=90

# ===========================================
# MULTI-FACTOR AUTHENTICATION (MFA)
# ===========================================

# Application name for TOTP (shows in authenticator apps)
MFA_APP_NAME="Dial-Craft CRM"

# Issuer name for TOTP QR codes
MFA_ISSUER="DigieEdge Solutions"

# TOTP window (how many time steps to allow, default 1 = 30 seconds)
MFA_TOTP_WINDOW=1

# Number of backup codes to generate per user
MFA_BACKUP_CODES_COUNT=8

# ===========================================
# SESSION SECURITY
# ===========================================

# Maximum concurrent sessions per user
MAX_CONCURRENT_SESSIONS=3

# Session timeout in minutes (default: 60 minutes)
SESSION_TIMEOUT_MINUTES=60

# Device fingerprint algorithm
DEVICE_FINGERPRINT_ALGORITHM="sha256"

# Session encryption key (different from field encryption)
# Generate with: openssl rand -base64 32
SESSION_ENCRYPTION_KEY="your-session-encryption-key-here"

# ===========================================
# RISK ASSESSMENT & SECURITY MONITORING
# ===========================================

# Risk score thresholds (0.0 to 1.0)
RISK_THRESHOLD_LOW=0.3
RISK_THRESHOLD_MEDIUM=0.6
RISK_THRESHOLD_HIGH=0.8

# Failed login attempt limits
MAX_FAILED_LOGINS=5
ACCOUNT_LOCKOUT_MINUTES=30

# Suspicious activity detection
ENABLE_ANOMALY_DETECTION=true
ANOMALY_DETECTION_SENSITIVITY=0.7

# Geographic restriction (comma-separated country codes)
ALLOWED_COUNTRIES="US,CA,UK"

# IP whitelist for admin access (comma-separated CIDR ranges)
ADMIN_IP_WHITELIST="192.168.1.0/24,10.0.0.0/8"

# ===========================================
# RATE LIMITING & THROTTLING
# ===========================================

# API rate limits per minute
RATE_LIMIT_GENERAL=100
RATE_LIMIT_AUTH=10
RATE_LIMIT_ADMIN=50

# Burst rate limits
BURST_RATE_LIMIT_GENERAL=200
BURST_RATE_LIMIT_AUTH=20

# ===========================================
# COMPLIANCE & AUDITING
# ===========================================

# Audit log retention period (in days)
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years for financial compliance

# Enable real-time audit alerts
ENABLE_AUDIT_ALERTS=true

# Security event notification webhook
SECURITY_WEBHOOK_URL="https://your-security-monitoring-system.com/webhook"

# Compliance mode (affects logging verbosity and retention)
COMPLIANCE_MODE="BANK_LEVEL"  # Options: STANDARD, HIGH, BANK_LEVEL

# ===========================================
# REDIS CONFIGURATION (for caching & sessions)
# ===========================================

# Redis connection for session storage and caching
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=""
REDIS_DB=0

# Session storage database (separate from general caching)
REDIS_SESSION_DB=1

# Cache TTL settings (in seconds)
PERMISSION_CACHE_TTL=300      # 5 minutes
RISK_SCORE_CACHE_TTL=60       # 1 minute
MFA_RATE_LIMIT_TTL=300        # 5 minutes

# ===========================================
# SECURITY HEADERS & CSP
# ===========================================

# Content Security Policy mode
CSP_MODE="STRICT"  # Options: PERMISSIVE, STANDARD, STRICT

# Allowed external domains for CSP
CSP_ALLOWED_DOMAINS="cdn.jsdelivr.net,fonts.googleapis.com,fonts.gstatic.com"

# Enable HSTS preload
HSTS_PRELOAD=true

# ===========================================
# NOTIFICATION SETTINGS
# ===========================================

# Email notifications for security events
SECURITY_EMAIL_ALERTS=true
SECURITY_EMAIL_RECIPIENT="security@your-company.com"

# Slack webhook for critical security alerts
SLACK_SECURITY_WEBHOOK=""

# SMS alerts for critical events (Twilio configuration)
TWILIO_ACCOUNT_SID=""
TWILIO_AUTH_TOKEN=""
TWILIO_PHONE_NUMBER=""
SECURITY_SMS_RECIPIENT=""

# ===========================================
# DEVELOPMENT & DEBUGGING
# ===========================================

# Enable security debug logging (only in development)
SECURITY_DEBUG_LOGGING=false

# Bypass certain security checks in development
DEVELOPMENT_SECURITY_BYPASS=false

# Mock external services in development
MOCK_EXTERNAL_SERVICES=false

# ===========================================
# BACKUP & RECOVERY
# ===========================================

# Encryption key backup location
ENCRYPTION_KEY_BACKUP_PATH="/secure/backups/keys"

# Database backup encryption
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY="your-backup-encryption-key-here"

# Recovery contact information
RECOVERY_CONTACT_EMAIL="recovery@your-company.com"
RECOVERY_CONTACT_PHONE="+1234567890"